<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content=""/>
  
  <title>高性能的key-value数据库-Redis | 淘淘的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="很多项目使用了Redis，找了一些资料简单的学习学习。">
<meta property="og:type" content="article">
<meta property="og:title" content="高性能的key-value数据库-Redis">
<meta property="og:url" content="http://tonylit.me/2017/10/11/高性能的key-value数据库-Redis/index.html">
<meta property="og:site_name" content="淘淘的博客">
<meta property="og:description" content="很多项目使用了Redis，找了一些资料简单的学习学习。">
<meta property="og:image" content="http://tonylit.me/img/redis/redis-server启动.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/redis-cli.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/string.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/hash.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/list.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/set.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/zset.PNG">
<meta property="og:image" content="http://tonylit.me/img/redis/connect.PNG">
<meta property="og:updated_time" content="2017-10-11T05:37:27.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="高性能的key-value数据库-Redis">
<meta name="twitter:description" content="很多项目使用了Redis，找了一些资料简单的学习学习。">
  
    <link rel="alternative" href="/atom.xml" title="淘淘的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/leaves.ico">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
  <script src="http://tonylit.me//js/jquery.nicescroll.js"></script>

</head>

<body>

  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
<form class="search" method="get" accept-charset="utf-8">
			<input type="text" id="chillax-search-input" class="st-search-input_my" maxlength="30" placeholder="search" />
		</form>


	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img src="/img/c.jpg" class="js-avatar">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/" class="alluraregular">tonyli</a></h1>
		</hgroup>
        <!--
		
		<p class="header-subtitle">Nothing is given. Everything is earned.</p>
		
        -->
		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>

				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags/work">工作日志</a></li>
				        
							<li><a href="/tags/life">点滴生活</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/tonylit" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/2136920064/profile?topnav=1&wvr=6" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/li-tao-40-20-98" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>

				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android/" style="font-size: 10px;">Android</a> <a href="/tags/Appium/" style="font-size: 12.86px;">Appium</a> <a href="/tags/Gatling/" style="font-size: 11.43px;">Gatling</a> <a href="/tags/Jmeter/" style="font-size: 11.43px;">Jmeter</a> <a href="/tags/Python/" style="font-size: 12.86px;">Python</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/apache/" style="font-size: 10px;">apache</a> <a href="/tags/atom/" style="font-size: 10px;">atom</a> <a href="/tags/docker/" style="font-size: 17.14px;">docker</a> <a href="/tags/java/" style="font-size: 18.57px;">java</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/life/" style="font-size: 10px;">life</a> <a href="/tags/loadrunner/" style="font-size: 14.29px;">loadrunner</a> <a href="/tags/pinpoint/" style="font-size: 10px;">pinpoint</a> <a href="/tags/scala/" style="font-size: 10px;">scala</a> <a href="/tags/work/" style="font-size: 15.71px;">work</a> <a href="/tags/性能/" style="font-size: 20px;">性能</a>
					</div>
				</section>
				

				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">Nothing is given. Everything is earned.</div>
				</section>
				
			</div>
		</div>
	</header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">tonyli</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img src="/img/c.jpg" class="js-avatar">
				<hgroup>
				  <h1 class="header-author">tonyli</h1>
				</hgroup>
			</div>
			
			<p class="header-subtitle">Nothing is given. Everything is earned.</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags/work">工作日志</a></li>
		        
					<li><a href="/tags/life">点滴生活</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/tonylit" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/2136920064/profile?topnav=1&wvr=6" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/li-tao-40-20-98" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>
	</div>
</nav>

	  <div class="recent">
高手的存在，就是让服务10亿人的时候，你感觉只是为你一个人服务......
</div>

      <div class="body-wrap"><article id="post-高性能的key-value数据库-Redis" class="article article-type-post" itemscope itemprop="blogPost">
    <script>
        $("html").niceScroll({
            cursorcolor: "#2a2929",
            cursoropacitymax: 1,
            touchbehavior: false,
            cursorwidth: "6px",
            cursorborder: "5",
            cursorborderradius: "0px",
            autohidemode: true
        });
    </script>
    
        <div class="article-meta">
            <a href="/2017/10/11/高性能的key-value数据库-Redis/" class="article-date">
  	<time datetime="2017-10-11T03:37:27.000Z" itemprop="datePublished">2017-10-11</time>
</a>

        </div>
        
            <div class="article-inner">
                
                    <input type="hidden" class="isFancy" />
                    
                        
                            <header class="article-header">
                                
  
    <h1 class="article-title" itemprop="name">
      高性能的key-value数据库-Redis
    </h1>
  


                            </header>
                            
                                <div class="article-info article-info-post">
                                    
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Redis/">Redis</a></li></ul>
	</div>


                                        

                                            <div class="clearfix"></div>
                                </div>
                                
                                    
                                        <div class="article-entry" itemprop="articleBody">
                                            
                                                    <!--02-->
                                                    <div id="toc" class="toc-article">
    <div class="toc-title">目录</div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis的特点"><span class="toc-number">1.</span> <span class="toc-text">Redis的特点</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据持久化"><span class="toc-number">1.1.</span> <span class="toc-text">数据持久化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#支持多数据结构数据"><span class="toc-number">1.2.</span> <span class="toc-text">支持多数据结构数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#性能高"><span class="toc-number">1.3.</span> <span class="toc-text">性能高</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#原子性"><span class="toc-number">1.4.</span> <span class="toc-text">原子性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis的安装"><span class="toc-number">2.</span> <span class="toc-text">Redis的安装</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis服务启动"><span class="toc-number">2.1.</span> <span class="toc-text">Redis服务启动</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Redis客户端启动"><span class="toc-number">2.2.</span> <span class="toc-text">Redis客户端启动</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Webdis_-A_Redis_HTTP_interface_with_JSON_output"><span class="toc-number">2.2.1.</span> <span class="toc-text">Webdis -A Redis HTTP interface with JSON output</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis的配置文件-redis-conf"><span class="toc-number">3.</span> <span class="toc-text">Redis的配置文件-redis.conf</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#基础命令"><span class="toc-number">4.</span> <span class="toc-text">基础命令</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#string"><span class="toc-number">4.1.</span> <span class="toc-text">string</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hash"><span class="toc-number">4.2.</span> <span class="toc-text">Hash</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#List"><span class="toc-number">4.3.</span> <span class="toc-text">List</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Set"><span class="toc-number">4.4.</span> <span class="toc-text">Set</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Zset"><span class="toc-number">4.5.</span> <span class="toc-text">Zset</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Java使用Redis"><span class="toc-number">5.</span> <span class="toc-text">Java使用Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#连接服务器"><span class="toc-number">5.1.</span> <span class="toc-text">连接服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#存取数据"><span class="toc-number">5.2.</span> <span class="toc-text">存取数据</span></a></li></ol></li></ol>
</div>

                                                        
                                                            
                                                                
                                                                            <p>很多项目使用了Redis，找了一些资料简单的学习学习。</p>
<a id="more"></a>
<hr>
<h1 id="Redis的特点">Redis的特点</h1><h2 id="数据持久化">数据持久化</h2><p>Redis支持数据的持久化，可以将内存中的数据保存到磁盘上，重启的时候再次加载使用。</p>
<h2 id="支持多数据结构数据">支持多数据结构数据</h2><p>Redis不仅仅支持简单的key-value类型的数据，同时还提供list，set，zset，hash等数据结构的存储。</p>
<h2 id="性能高">性能高</h2><p>使用Redis自带的性能测试工具-redis-benchmark测试，单机读写均在5w/s以上。</p>
<h2 id="原子性">原子性</h2><p> Redis的所有操作都是原子性的，一个事物要么成功执行要么失败完全不执行。</p>
<hr>
<h1 id="Redis的安装">Redis的安装</h1><p>下载地址：<a href="http://redis.io/download" target="_blank" rel="external">http://redis.io/download</a></p>
<blockquote>
<p>tar -xvf redis-4.0.2.tar.gz<br>cd redis-4.0.2<br>make </p>
</blockquote>
<h2 id="Redis服务启动">Redis服务启动</h2><p>编译完成后进入src目录，里面有服务端、客户端启动脚本。</p>
<blockquote>
<p>./redis-server ../redis.conf </p>
</blockquote>
<p><img src="/img/redis/redis-server启动.PNG" alt="Alt text"></p>
<p>启动后默认的端口为6379，pid：9986，这些可以在redis.conf中设置。</p>
<h2 id="Redis客户端启动">Redis客户端启动</h2><blockquote>
<p>./redis-cli</p>
</blockquote>
<p><img src="/img/redis/redis-cli.PNG" alt="Alt text"></p>
<p>如果需要在其他服务器上执行命令，可以使用：</p>
<blockquote>
<p>./redis-cli -h host -p port -a password 的方式</p>
</blockquote>
<p>port和password 可以在redis.conf中设置（port与requirepass）。</p>
<h3 id="Webdis_-A_Redis_HTTP_interface_with_JSON_output">Webdis -A Redis HTTP interface with JSON output</h3><p>如果你觉得命令行方式操作redis不习惯，可以使用HTTP接口的方式。<br>Webdis 就是这么一款工具，为 Redis 提供 HTTP 接口，通过 HTTP 即可直接操作 Redis。</p>
<p><strong>项目地址</strong>：<br><a href="https://github.com/nicolasff/webdis" target="_blank" rel="external">https://github.com/nicolasff/webdis</a></p>
<p><strong>安装</strong>：</p>
<blockquote>
<p>git clone git://github.com/nicolasff/webdis.git<br>cd webdis<br>make clean all<br>./webdis &amp;</p>
</blockquote>
<p>然后可以通过http的方式操作redis了：</p>
<blockquote>
<p>curl <a href="http://127.0.0.1:7379/SET/hello/world" target="_blank" rel="external">http://127.0.0.1:7379/SET/hello/world</a><br>{“SET”:[true,”OK”]}</p>
<p>curl <a href="http://127.0.0.1:7379/GET/hello" target="_blank" rel="external">http://127.0.0.1:7379/GET/hello</a><br>{“GET”:”world”}</p>
<p>curl -d “GET/hello” <a href="http://127.0.0.1:7379/" target="_blank" rel="external">http://127.0.0.1:7379/</a><br>{“GET”:”world”}</p>
</blockquote>
<hr>
<h1 id="Redis的配置文件-redis-conf">Redis的配置文件-redis.conf</h1><p>参数说明：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程</span><br><span class="line">    daemonize no</span><br><span class="line"><span class="number">2.</span> 当Redis以守护进程方式运行时，Redis默认会把pid写入/var/run/redis.pid文件，可以通过pidfile指定</span><br><span class="line">    pidfile /var/run/redis.pid</span><br><span class="line"><span class="number">3.</span> 指定Redis监听端口，默认端口为<span class="number">6379</span></span><br><span class="line">    port <span class="number">6379</span></span><br><span class="line"><span class="number">4.</span> 绑定的主机地址</span><br><span class="line">    bind <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="number">5.</span> 当客户端闲置多长时间后关闭连接，如果指定为<span class="number">0</span>，表示关闭该功能</span><br><span class="line">    timeout <span class="number">300</span></span><br><span class="line"><span class="number">6.</span> 日志级别，Redis总共支持四个级别：debug、verbose、notice、warning，默认为verbose</span><br><span class="line">    loglevel verbose</span><br><span class="line"><span class="number">7.</span> 日志记录方式，默认为标准输出，如果配置Redis为守护进程方式运行，而这里又配置为日志记录方式为标准输出，则日志将会发送给/dev/null</span><br><span class="line">    logfile <span class="built_in">stdout</span></span><br><span class="line"><span class="number">8.</span> 设置数据库的数量，默认数据库为<span class="number">0</span>，可以使用SELECT &lt;dbid&gt;命令在连接上指定数据库id</span><br><span class="line">    databases <span class="number">16</span></span><br><span class="line"><span class="number">9.</span> 指定在多长时间内，有多少次更新操作，就将数据同步到数据文件，可以多个条件配合</span><br><span class="line">    save &lt;seconds&gt; &lt;changes&gt;</span><br><span class="line">    Redis默认配置文件中提供了三个条件：</span><br><span class="line">    save <span class="number">900</span> <span class="number">1</span></span><br><span class="line">    save <span class="number">300</span> <span class="number">10</span></span><br><span class="line">    save <span class="number">60</span> <span class="number">10000</span></span><br><span class="line">    分别表示<span class="number">900</span>秒（<span class="number">15</span>分钟）内有<span class="number">1</span>个更改，<span class="number">300</span>秒（<span class="number">5</span>分钟）内有<span class="number">10</span>个更改以及<span class="number">60</span>秒内有<span class="number">10000</span>个更改。</span><br><span class="line"> </span><br><span class="line"><span class="number">10.</span> 指定存储至本地数据库时是否压缩数据，默认为yes，Redis采用LZF压缩，如果为了节省CPU时间，可以关闭该选项，但会导致数据库文件变的巨大</span><br><span class="line">    rdbcompression yes</span><br><span class="line"><span class="number">11.</span> 指定本地数据库文件名，默认值为dump.rdb</span><br><span class="line">    dbfilename dump.rdb</span><br><span class="line"><span class="number">12.</span> 指定本地数据库存放目录</span><br><span class="line">    dir ./</span><br><span class="line"><span class="number">13.</span> 设置当本机为slav服务时，设置master服务的IP地址及端口，在Redis启动时，它会自动从master进行数据同步</span><br><span class="line">    slaveof &lt;masterip&gt; &lt;masterport&gt;</span><br><span class="line"><span class="number">14.</span> 当master服务设置了密码保护时，slav服务连接master的密码</span><br><span class="line">    masterauth &lt;master-password&gt;</span><br><span class="line"><span class="number">15.</span> 设置Redis连接密码，如果配置了连接密码，客户端在连接Redis时需要通过AUTH &lt;password&gt;命令提供密码，默认关闭</span><br><span class="line">    requirepass foobared</span><br><span class="line"><span class="number">16.</span> 设置同一时间最大客户端连接数，默认无限制，Redis可以同时打开的客户端连接数为Redis进程可以打开的最大文件描述符数，如果设置 maxclients <span class="number">0</span>，表示不作限制。当客户端连接数到达限制时，Redis会关闭新的连接并向客户端返回max number of clients reached错误信息</span><br><span class="line">    maxclients <span class="number">128</span></span><br><span class="line"><span class="number">17.</span> 指定Redis最大内存限制，Redis在启动时会把数据加载到内存中，达到最大内存后，Redis会先尝试清除已到期或即将到期的Key，当此方法处理 后，仍然到达最大内存设置，将无法再进行写入操作，但仍然可以进行读取操作。Redis新的vm机制，会把Key存放内存，Value会存放在swap区</span><br><span class="line">    maxmemory &lt;bytes&gt;</span><br><span class="line"><span class="number">18.</span> 指定是否在每次更新操作后进行日志记录，Redis在默认情况下是异步的把数据写入磁盘，如果不开启，可能会在断电时导致一段时间内的数据丢失。因为 redis本身同步数据文件是按上面save条件来同步的，所以有的数据会在一段时间内只存在于内存中。默认为no</span><br><span class="line">    appendonly no</span><br><span class="line"><span class="number">19.</span> 指定更新日志文件名，默认为appendonly.aof</span><br><span class="line">     appendfilename appendonly.aof</span><br><span class="line"><span class="number">20.</span> 指定更新日志条件，共有<span class="number">3</span>个可选值： </span><br><span class="line">    no：表示等操作系统进行数据缓存同步到磁盘（快） </span><br><span class="line">    always：表示每次更新操作后手动调用fsync()将数据写到磁盘（慢，安全） </span><br><span class="line">    everysec：表示每秒同步一次（折衷，默认值）</span><br><span class="line">    appendfsync everysec</span><br><span class="line"> </span><br><span class="line"><span class="number">21.</span> 指定是否启用虚拟内存机制，默认值为no，简单的介绍一下，VM机制将数据分页存放，由Redis将访问量较少的页即冷数据swap到磁盘上，访问多的页面由磁盘自动换出到内存中</span><br><span class="line">     vm-enabled no</span><br><span class="line"><span class="number">22.</span> 虚拟内存文件路径，默认值为/tmp/redis.swap，不可多个Redis实例共享</span><br><span class="line">     vm-swap-file /tmp/redis.swap</span><br><span class="line"><span class="number">23.</span> 将所有大于vm-max-memory的数据存入虚拟内存,无论vm-max-memory设置多小,所有索引数据都是内存存储的(Redis的索引数据 就是keys),也就是说,当vm-max-memory设置为<span class="number">0</span>的时候,其实是所有value都存在于磁盘。默认值为<span class="number">0</span></span><br><span class="line">     vm-max-memory <span class="number">0</span></span><br><span class="line"><span class="number">24.</span> Redis swap文件分成了很多的page，一个对象可以保存在多个page上面，但一个page上不能被多个对象共享，vm-page-size是要根据存储的 数据大小来设定的，建议如果存储很多小对象，page大小最好设置为<span class="number">32</span>或者<span class="number">64</span>bytes；如果存储很大大对象，则可以使用更大的page，如果不 确定，就使用默认值</span><br><span class="line">     vm-page-size <span class="number">32</span></span><br><span class="line"><span class="number">25.</span> 设置swap文件中的page数量，由于页表（一种表示页面空闲或使用的bitmap）是在放在内存中的，，在磁盘上每<span class="number">8</span>个pages将消耗<span class="number">1</span>byte的内存。</span><br><span class="line">     vm-pages <span class="number">134217728</span></span><br><span class="line"><span class="number">26.</span> 设置访问swap文件的线程数,最好不要超过机器的核数,如果设置为<span class="number">0</span>,那么所有对swap文件的操作都是串行的，可能会造成比较长时间的延迟。默认值为<span class="number">4</span></span><br><span class="line">     vm-max-threads <span class="number">4</span></span><br><span class="line"><span class="number">27.</span> 设置在向客户端应答时，是否把较小的包合并为一个包发送，默认为开启</span><br><span class="line">    glueoutputbuf yes</span><br><span class="line"><span class="number">28.</span> 指定在超过一定的数量或者最大的元素超过某一临界值时，采用一种特殊的哈希算法</span><br><span class="line">    hash-max-zipmap-entries <span class="number">64</span></span><br><span class="line">    hash-max-zipmap-value <span class="number">512</span></span><br><span class="line"><span class="number">29.</span> 指定是否激活重置哈希，默认为开启（后面在介绍Redis的哈希算法时具体介绍）</span><br><span class="line">    activerehashing yes</span><br><span class="line"><span class="number">30.</span> 指定包含其它的配置文件，可以在同一主机上多个Redis实例之间使用同一份配置文件，而同时各个实例又拥有自己的特定配置文件</span><br><span class="line">    include /path/to/local.conf</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="基础命令">基础命令</h1><p>Redis支持5中数据类型：string（字符串），hash（哈希），list（列表），set（集合）及zset(sorted set：有序集合)。</p>
<h2 id="string">string</h2><p><strong>set 存值</strong><br><strong>get取值</strong></p>
<p><img src="/img/redis/string.PNG" alt="Alt text"></p>
<h2 id="Hash">Hash</h2><p>Redis hash是一个string类型的field和value的映射表，适合用于存储对象。 </p>
<p><strong>Hmset 存值 </strong><br><strong>Hgetall 取值 </strong></p>
<p><img src="/img/redis/hash.PNG" alt="Alt text"></p>
<h2 id="List">List</h2><p>Redis列表是简单的字符串列表，按照插入顺序排序。可以添加一个元素到列表的头部（左边）或者尾部（右边）。<br>一个列表最多可以包含 232 - 1 个元素 (4294967295, 每个列表超过40亿个元素)。</p>
<p><strong>Lpush 插入 </strong><br><strong>Lrange 查看 </strong></p>
<p><img src="/img/redis/list.PNG" alt="Alt text"></p>
<h2 id="Set">Set</h2><p>Redis的Set是string类型的无序集合。集合成员是唯一的。<br>Redis 中 集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。<br>集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p>
<p> <strong>sadd 插入 </strong><br> <strong>smembers查看 </strong><br><img src="/img/redis/set.PNG" alt="Alt text"></p>
<h2 id="Zset">Zset</h2><p>Redis 有序集合和集合一样也是string类型元素的集合,且不允许重复的成员。<br>不同的是每个元素都会关联一个double类型的分数。redis正是通过分数来为集合中的成员进行从小到大的排序。<br>有序集合的成员是唯一的,但分数(score)却可以重复。<br>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。 集合中最大的成员数为 232 - 1 (4294967295, 每个集合可存储40多亿个成员)。</p>
<p> <strong>zadd 插入  </strong><br> <strong>zrangebyscore 查看 </strong></p>
<p><img src="/img/redis/zset.PNG" alt="Alt text"></p>
<hr>
<h1 id="Java使用Redis">Java使用Redis</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">dependency</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="title">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="title">groupId</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="title">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="title">artifactId</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="title">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="title">version</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="title">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>或者下载jar包 <a href="https://pan.baidu.com/s/1miSlXrU" target="_blank" rel="external">https://pan.baidu.com/s/1miSlXrU</a></p>
<h2 id="连接服务器">连接服务器</h2><p>连接的是linux服务器上的redis，</p>
<ol>
<li>先把防火墙关掉 systemctl stop firewalld.service  </li>
<li>修改redis.conf 中的 bind 127.0.0.1 注释掉，protected-mode no设置为no。</li>
</ol>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">import redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyRedis</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(<span class="params">String[] args</span>) </span>&#123;</span><br><span class="line">		String jedisAddr = <span class="string">"192.168.1.111"</span>;</span><br><span class="line">		Jedis jedis = <span class="keyword">new</span> Jedis(jedisAddr);</span><br><span class="line"></span><br><span class="line">System.<span class="keyword">out</span>.println(<span class="string">"连接测试"</span>);		System.<span class="keyword">out</span>.println(jedis.ping());</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/img/redis/connect.PNG" alt="Alt text"></p>
<h2 id="存取数据">存取数据</h2><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> redis.clients.jedis.Jedis;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> class RedisKeyAndValue &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(<span class="keyword">String</span>[] args) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// redis服务器地址</span></span><br><span class="line">		<span class="keyword">String</span> redisServerAddr = <span class="string">"192.168.1.111"</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// redis连接测试</span></span><br><span class="line">		Jedis jedis = redisConnect(redisServerAddr);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// string数据存取</span></span><br><span class="line">		redisStringTest(jedis);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// List数据存取</span></span><br><span class="line">		redisListTest(jedis);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// set数据存取</span></span><br><span class="line">		redisSetTest(jedis);</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * redis连接测试</span><br><span class="line">	 *</span><br><span class="line">	 * @param redisServerAddr</span><br><span class="line">	 * @return</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> Jedis redisConnect(<span class="keyword">String</span> redisServerAddr) &#123;</span><br><span class="line"></span><br><span class="line">		Jedis jedis = <span class="keyword">new</span> Jedis(redisServerAddr);</span><br><span class="line">		System.out.<span class="built_in">println</span>(<span class="string">"redis连接测试"</span>);</span><br><span class="line">		System.out.<span class="built_in">println</span>(jedis.ping());</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> jedis;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * String数据存取</span><br><span class="line">	 *</span><br><span class="line">	 * @param jedis</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> redisStringTest(Jedis jedis) &#123;</span><br><span class="line">		jedis.<span class="built_in">set</span>(<span class="string">"string"</span>, <span class="string">"xxx"</span>);</span><br><span class="line"></span><br><span class="line">		System.out.<span class="built_in">println</span>(<span class="string">"string :"</span> + jedis.<span class="built_in">get</span>(<span class="string">"string"</span>));</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * List数据存取</span><br><span class="line">	 *</span><br><span class="line">	 * @param jedis</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> redisListTest(Jedis jedis) &#123;</span><br><span class="line">		jedis.lpush(<span class="string">"list"</span>, <span class="string">"a"</span>);</span><br><span class="line">		jedis.lpush(<span class="string">"list"</span>, <span class="string">"b"</span>);</span><br><span class="line">		jedis.lpush(<span class="string">"list"</span>, <span class="string">"c"</span>);</span><br><span class="line">		jedis.lpush(<span class="string">"list"</span>, <span class="string">"d"</span>);</span><br><span class="line"></span><br><span class="line">		List&lt;<span class="keyword">String</span>&gt; list = jedis.lrange(<span class="string">"list"</span>, <span class="number">0</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">String</span> <span class="built_in">str</span> : list) &#123;</span><br><span class="line"></span><br><span class="line">			System.out.<span class="built_in">println</span>(<span class="string">"List:"</span> + <span class="built_in">str</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span><br><span class="line">	 * set数据存取</span><br><span class="line">	 *</span><br><span class="line">	 * @param jedis</span><br><span class="line">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> redisSetTest(Jedis jedis) &#123;</span><br><span class="line">		jedis.sadd(<span class="string">"set"</span>, <span class="string">"a"</span>);</span><br><span class="line">		jedis.sadd(<span class="string">"set"</span>, <span class="string">"b"</span>);</span><br><span class="line">		jedis.sadd(<span class="string">"set"</span>, <span class="string">"c"</span>);</span><br><span class="line">		jedis.sadd(<span class="string">"set"</span>, <span class="string">"c"</span>);</span><br><span class="line">		jedis.sadd(<span class="string">"set"</span>, <span class="string">"c"</span>);</span><br><span class="line"></span><br><span class="line">		Set&lt;<span class="keyword">String</span>&gt; <span class="built_in">set</span> = jedis.smembers(<span class="string">"set"</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">String</span> <span class="built_in">str</span> : <span class="built_in">set</span>) &#123;</span><br><span class="line">			System.out.<span class="built_in">println</span>(<span class="string">"set:"</span> + <span class="built_in">str</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<hr>
<p>参考文献：<br><a href="http://www.runoob.com/redis/redis-tutorial.html" target="_blank" rel="external">http://www.runoob.com/redis/redis-tutorial.html</a></p>

                                                                                
                                        </div>
                                        
            </div>
            
                <div class="bdsharebuttonbox" style="margin-top:10px;margin-left:30px;float:left;">
                    <a title="分享到QQ空间" href="#" class="bds_qzone" data-cmd="qzone"></a>
                    <a title="分享到新浪微博" href="#" class="bds_tsina" data-cmd="tsina"></a>
                    <a title="分享到腾讯微博" href="#" class="bds_tqq" data-cmd="tqq"></a>
                    <a title="分享到人人网" href="#" class="bds_renren" data-cmd="renren"></a>
                    <a title="分享到微信" href="#" class="bds_weixin" data-cmd="weixin"></a>
                    <a href="#" class="bds_more" data-cmd="more"></a>
                </div>
                <script>
                    window._bd_share_config = {
                        "common": {
                            "bdSnsKey": {},
                            "bdText": "",
                            "bdMini": "1",
                            "bdMiniList": false,
                            "bdStyle": "2",
                            "bdSize": "16"
                        },
                        "share": {}
                    };
                    with(document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement('script')).src = 'http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion=' + ~(-new Date() / 36e5)];
                </script>
                
                    
                        
<nav id="article-nav">
  
    <a href="/2017/10/30/Welcome to Python/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Welcome to Python
        
      </div>
    </a>
  
  
    <a href="/2017/09/20/tcpcopy的兄弟-gor/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">tcpcopy的兄弟-gor</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>


                            
                                <!-- 多说评论框 start -->
                                
                                    <div class="ds-thread" data-thread-key="post-高性能的key-value数据库-Redis" data-title="高性能的key-value数据库-Redis" data-url="http://tonylit.me/2017/10/11/高性能的key-value数据库-Redis/"></div>
                                    <!-- 多说评论框 end -->
                                    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
                                    <script type="text/javascript">
                                        var duoshuoQuery = {
                                            short_name: "tonylit"
                                        };
                                        (function() {
                                            var ds = document.createElement('script');
                                            ds.type = 'text/javascript';
                                            ds.async = true;
                                            ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                                            ds.charset = 'UTF-8';
                                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
                                        })();
                                    </script>
                                    <!-- 多说公共JS代码 end -->
                                    
</article>

<!--

    <div style="width:100%;background-color:#fff;">
        <div id="uyan_frame" style="margin:auto 10px 10px 10px;"></div>
    </div>
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2017540"></script>
    
-->
<!--

-->

</div>
      <!--<footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2018 tonyli
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
    
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','ZDWgkzoEyRjqY6u-8gjX','2.0.0');
</script>
   
  </div>
</footer>-->
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/mobile.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>
<script src="/js/prefixfree.js" type="text/javascript"></script>
<script src="/js/require-2.1.20.js" type="text/javascript"></script>
<script src="/js/jquery-1.9.1.min.js" type="text/javascript"></script>




<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div id="totop" style="position:fixed;bottom:150px;right:50px;cursor: pointer;z-index:9999;opacity: 100%;">
    <a title="返回顶部" style="opacity: 100%;">
        <img src="/img/scrollup.png" />
    </a>
</div>

<script src="/js/totop.js"></script>

<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','ZDWgkzoEyRjqY6u-8gjX','2.0.0');
</script>

  </div>
</body>
</html>
